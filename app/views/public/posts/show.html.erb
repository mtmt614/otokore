<div class="container my-5">
  <h3 class="text-center"><span style="background-color: gainsboro">詳細</span></h3>
</div>

<% if @post.user == current_user %>
    <div class="col-2 ml-auto">
        <%= link_to "編集する", edit_post_path, class:"btn btn-primary py-1" %>
      </div>
  <% end %>

<div class="container my-5">
    <div class="text-center">

      <div class="row">
        <div class="col-md-3">
          <%= "曲名" %>
        </div>
        <div class="h4 col-md-5" >
          <%= @post.title %>
        </div>
      </div>

      <div class="row">
        <div class="col-md-3">
          <%= "アーティスト" %>
        </div>
        <div class="h4 col-md-5" >
          <%= @post.artist %>
        </div>
      </div>

      <div class="row">
        <div class="col-md-3">
          <%= "ジャンル" %>
        </div>
        <div class="h4 col-md-5" >
          <%= @post.genre.genrename %>
        </div>
      </div>
      
      <div class="row">
        <div class="col-md-3">
          <%= "ひとこと" %>
        </div>
        <div class="h4 col-md-5" >
          <%= @post.content %>
        </div>
      <div class="row">
        <div class="col-md-3">
          <%= "投稿日" %>
        </div>
        <div class="h4 col-md-5" >
          <%= @post.created_at.strftime('%Y/%m/%d') %>
        </div>
      </div>

  <% if current_user.email != 'guest@email.com'%>   
  <% if @post.liked_by?(current_user) %>
    <p>
      <%= link_to post_likes_path(@post), method: :delete do %>
        ♥<%= @post.likes.count %> いいね
      <% end %>
    </p>
      <% else %>
    <p>
      <%= link_to post_likes_path(@post), method: :post do %>
        ♡<%= @post.likes.count %> いいね
      <% end %>
    </p>
  <% end %>
  <% end %>
  </div>
  </div>
  
  <% if current_user.email != 'guest@email.com'%>
  <div class="row mb-3 ">
      <div class="col-md-9 px-0 mx-auto">
        <table id="comments">
  <% @post.comments.each do |comment| %>
  <tr>
    <td><%= comment.user.name %>：</td>
    <td><%= comment.body %></td>
    <td>(<%= comment.created_at.strftime('%Y/%m/%d') %>)</td>
    <td>
      <% if comment.user == current_user %>
        <%= link_to "削除", post_comment_path(post_id: comment.post_id, id: comment.id), method: :delete, remote: true, class:"btn btn-danger py-1", data: { confirm: '削除しますか？' } %>
      <% end %>
    </td>
  </tr>
<% end %>
</table>
      </div>
    </div>

<div class="row mb-3">
      <div class="col-md-9 px-0 mx-auto">
<%= form_with(model:[@post, @comment], local: false, class:"form-inline") do |f| %>
  <%= f.text_area :body, class:"col-md-3 form-control", size:"20x1", placeholder: "コメントをここに" %>
  <%= f.submit "投稿", class:"btn btn-primary py-1" %>
<% end %>
</div>
    </div>
    
  
<% end %>
    </div>
  </div>
</div>
